<!DOCTYPE html>
<html>
<head>
    <script src="https://www.gstatic.com/firebasejs/3.0.5/firebase.js"></script>
    <script src="init.js"></script>
    
   <script>
       var config = {
      apiKey: "AIzaSyC5vrJU4FkBRmGzAYMvtqYXu3F06OC7bQM",
      authDomain: "science-bowl.firebaseapp.com",
      databaseURL: "https://science-bowl.firebaseio.com",
      storageBucket: "science-bowl.appspot.com",
    };
    firebase.initializeApp(config);
  </script>
    <script type="text/javascript">
    firebase.auth().onAuthStateChanged(function(user) {
  if (!user){
    location.replace(LOGIN);
  }
});
      function sendStuff() {
          var subjSel = document.getElementById("subject");
          var inQuest = document.getElementById("question");
          var inW = document.getElementById("optionW");
          var inX = document.getElementById("optionX");
          var inY = document.getElementById("optionY");
          var inZ = document.getElementById("optionZ");
          var inCorr = document.getElementById("correct");
          var subSubjSel = document.getElementById("subSubject");
          var diffSel = document.getElementById("diff");
          var subj = subjSel.options[subjSel.selectedIndex].value;
          var subSubj = subSubjSel.options[subSubjSel.selectedIndex].value;
          var diff = diffSel.options[diffSel.selectedIndex].value;
        
        sessionStorage.clear();
        sessionStorage.setItem("question",inQuest.value);
        sessionStorage.setItem("inW",inW.value);
        sessionStorage.setItem("inX",inX.value);
        sessionStorage.setItem("inY",inY.value);
        sessionStorage.setItem("inZ",inZ.value);
        sessionStorage.setItem("subj", subj);
        sessionStorage.setItem("subSubj", subSubj);
        sessionStorage.setItem("diff", diff);
        sessionStorage.setItem("correct",inCorr.value);
        window.location.href = CONF;
       
      }
     
      function signOut(){
      firebase.auth().signOut().then(function() {
  // Sign-out successful.
  alert("good");
  //location.replace("index.html");
}, function(error) {
  // An error happened.
});
      }

function populate(s1, s2){
    var s1 = document.getElementById(s1);
    var s2 = document.getElementById(s2);
    s2.innerHTML="";
    var optionArray;
    if(s1.value == "Biology"){
        optionArray = ["Anatomy|Anatomy","Plant Biology|Plant Biology", "Ecology|Ecology"];
    }else if(s1.value == "Chemistry"){
        optionArray = ["Orgo|Organic Chem"];
    }else if(s1.value == "Physics"){
        optionArray = [""];
    }else if(s1.value == "Earth Science"){
        optionArray = [""];
    }else if(s1.value == "Astronomy"){
        optionArray = [""];
    }else if(s1.value == "Energy"){
        optionArray = [""];
    }else if(s1.value == "Math"){
        optionArray = ["Calculation|Calculation"];
    }
    for(var option in optionArray){
		var pair = optionArray[option].split("|");
		var newOption = document.createElement("option");
		newOption.value = pair[0];
		newOption.innerHTML = pair[1];
		s2.options.add(newOption);
	}
}

function init(){
    
     //console.log(firebase.auth().currentUser);
    if(sessionStorage.subj == undefined){
        return;
    }
     var subj = document.getElementById("subject");
     subj.value = sessionStorage.subj;   
          var inQuest = document.getElementById("question");
          inQuest.value = sessionStorage.question;
          var inW = document.getElementById("optionW");
          inW.value = sessionStorage.inW;
          var inX = document.getElementById("optionX");
          inX.value = sessionStorage.inX;
          var inY = document.getElementById("optionY");
          inY.value = sessionStorage.inY;
          var inZ = document.getElementById("optionZ");
          inZ.value = sessionStorage.inZ;
          var inCorr = document.getElementById("correct");
          inCorr.value = sessionStorage.correct;
          var subSubjSel = document.getElementById("subSubject");
          subSubjSel.value = sessionStorage.subSubj;
          var diffSel = document.getElementById("diff");
          diffSel.value = sessionStorage.diff;
         
}

    </script>
<title>Question Entry</title>
</head>
<body onload="init()">

<h1>Enter your question</h1>
<form action="javascript:sendStuff()" autocomplete="off">
    Subject: <select id="subject" onchange="populate(this.id,'subSubject')">
      <option value = "Biology">Biology</option>
      <option value = "Physics">Physics</option>
      <option value = "Chemistry">Chemistry</option>
      <option value = "Earth_Science">Earth Science</option>
      <option value = "Astronomy">Astronomy</option>
      <option value = "Energy">Energy</option>  
       <option value = "Math">Math</option>
      </select><br>
      Sub-Subject:<select id = "subSubject">
          <option value="Anatomy">Anatomy</option>
              <option value="Plant Biology">Plant Biology</option>
              <option value="Ecology">Ecology</option>
          </select> <br>
      Difficulty: <select id = "diff">
          <option value = "0">0</option><br>
          <option value = "1">1</option><br>
          <option value = "2">2</option><br>
          <option value = "3">3</option><br>
          <option value = "4">4</option><br>
          <option value = "5">5</option><br>
          </select> <br><br>
  Question:<br> <textarea rows="5" cols="80" id="question"></textarea><br>
  W: <input type="text" id="optionW"> <br>
  X: <input type="text" id="optionX"> <br>
  Y: <input type="text" id="optionY"> <br>
  Z: <input type="text" id="optionZ"> <br>
    Correct Answer: <select id = "correct">
      <option value = "w">W</option>
      <option value = "x">X</option>
      <option value = "y">Y</option>
      <option value = "z">Z</option>
      </select><br>
      <input type="submit" value="Submit">
</form>
<button onclick="signOut()">Sign Out</button>
</body>
</html>